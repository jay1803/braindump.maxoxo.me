+++
title = "SaaS 产品之PostHog"
author = ["Max Zhang"]
tags = ["post"]
draft = false
+++

## SaaS 产品之 PostHog <span class="tag"><span class="ATTACH">ATTACH</span></span> {#saas-产品之-posthog}

[PostHog](https://posthog.com/)（以下简称 PH） 是一款数据分析工具，简单来说就是 Google Analytics（简称 GA） 的替代品，市面上有还很多的类似产品，也不乏一些开源免费的产品，实际上 PostHog 也是一款开源产品，而且还非常年轻，公司在 2020 年 1 月才成立[^fn:1]，4 周之后推出了 MVP 版本，当年 4 月份的时候就拿到 $3M 的种子轮，5 月份的用户量就已经有 1000 了，同年 12 月的时候拿到 $9M 的 A 轮，2021 年 6 的时候就拿到了 $15M 的 B 轮，整个公司一共 30 个人分布在 12 个不同的国家。不得不说是一个快速增长的公司。现在 PH 的客户已经包括了 SpaceX 以及 Airbus 这样的大厂。

<a id="figure--fig:"></a>

{{< figure src="/ox-hugo/_20220907_231945screenshot.png" >}}


### Feature <span class="tag"><span class="ATTACH">ATTACH</span></span> {#feature}

GA 目前有两个版本，旧版本的 UA（Universal Analytic）算是上一代，有很多内建的报表，但是数据模型是基于 Session 的，所有事件都必须使用 UA 定义好的格式。最新一代的 GA4 把模型基于事件，基于事件的数据模型更加灵活，可以在事件中加上自定义的参数来进行更灵活的分析，但是因为 GA4 还比较「年轻」，自带的模版相较于 UA 基本上都是残废，很多报表都需要依赖于 Data Studio 来创建。并且无论是 UA 还是 GA4，后端事件的追踪都很复杂，GA4 的 API 还没有 stable，意味着无法用于生产环境。虽然我相信 GA4 一定是未来，但是要给 Google 点时间来准备。

相较于 GA，PH 更加简单，而且完全可以自定义数据模型，不同于 GA 所有的 Event 都是跟一个 User 绑定的，PH 也必须跟一个 Person（相当于 User）绑定，在除此之外还可以绑定 5 个不同类型的 Group。Group 是另外一种组织 Person 的方式，尤其在 ToB 的软件中，Account（个人账户）通常都是隶属于一个 Organization（企业账号），这种相互嵌套的账户体系在 GA 中几乎是无解，而 PH 则很好的解决了这个问题。这也是我们最终选择 PH 的原因，Google 作为一个 SaaS 大厂却做不出对 SaaS 友好的数据分析工具也着实令人诧异。

基于事件的 PH 在分析方面做了不少延伸，GA 中你需要自己维护一张 GSheet 来记录都有哪些事件发送到了 GA，其中的参数分别是什么。PH 中自带一个 Data Management 功能，会自动分析所有发送到 PH 的事件和其中的参数，并全部呈现出来，同样你可以给事件添加描述，来记录事件是什么时候触发以及用来做什么，同时里面的每个属性也会展示一个样本。

<a id="figure--fig:"></a>

{{< figure src="/ox-hugo/_20220907_231520screenshot.png" >}}

<a id="figure--fig:"></a>

{{< figure src="/ox-hugo/_20220907_231614screenshot.png" >}}

PH 的报表也很强大，我最常用的莫过于 Funnel，这点 GA 也是做的非常差，虽然 GA 可以关联强大的 Data Studio，但是后者的上手成本太高。PH 的 Funnel 既可以看转化率，还可以看转化所需要的时间，对于衡量用户体验中的 TTV（[Time to Value]({{< relref "20220227223812-time_to_value.md" >}})）指标就非常有帮助。

<a id="figure--fig:"></a>

{{< figure src="/ox-hugo/_20220907_233059screenshot.png" >}}

PH 内置灰度发布和 AB 测试的工具，你可以确定一部分用户给他们设定 Feature flag，业务可以根据用户的 Feature flag 来开启和关闭对应的功能，或者分别进入不同的实验组。虽然 Google 的套件中也有 Optimize 来专门做 AB 测试，但是上手成本还是太高。


### 商业模式 <span class="tag"><span class="ATTACH">ATTACH</span></span> {#商业模式}

PH 的收费有两种策略，最基本的是基于事件的数量收费（quota），每个月头 100 万个事件是免费的，对于中小客户来说还是足够的。每个月的数量越多费用自然也越贵，事件的数量收费标准是梯度的，类似于税收，数量越大的部分收费越低。

<a id="figure--fig:"></a>

{{< figure src="/ox-hugo/_20220906_233536screenshot.png" >}}

既然是开源产品，你其实自己可以部署一套私有化的 PH，不一定需要买 Cloud 版，但即便是私有化部署，高级的功能依然需要购买 License 才可以使用。但是自己部署的成本太高，我们再尝试之后最终选择放弃，SRE 折腾了很长时间服务依然不稳定。基本上绝大多数开源软件也都是这种讨论，RedHat 最初也是如此，RedHat 的系统也是开源使用，但是部署成本极高，除非你有能力并且愿意花时间去研究，绝大多数用户还是会选择购买他们的服务。

对于开源软件来说，开源实际上是吸引用户的方法，对用户来说可以很低的成本尝试产品，尤其是向 PH 这样的产品，如果走传统 SaaS 产品的 Freemium 或者 Free trial，后者几乎不可行，因为数据的继承本身需要花费大把事件，除非设定足够长的 trial 周期。而开源实际上就是一个周期无限长的试用版本，因为他相信你最终还是会来购买 Cloud 版的。Freemium 其实就是头 100 万个事件免费的模式，显然这些都是面向中小企业，初创企业，这些公司也没钱去买更贵的服务，如果量稍微大一点可能会直接用 GA，毕竟后者目前还是免费的。GA4 目前还没有推出付费套餐，但结合 GA360 的模式，应该也是按照事件量收费，只不过 GA 的事件的门槛非常之高，部分中型企业实际上也是足够了，毕竟 GA360 算下来比 PH 还是要贵不少的。

PH 还有两个我用的比较少的功能，一个是 Sesson recording，另外一个是 Heatmap，前者可以「录屏」来记录用户是如何使用产品的，后者则可以看到某一个页面上用户在哪个区域的点击最多。Hotjar 也有类似的功能，不过我们在更早的时候选择 [Microsoft]({{< relref "20220117204930-microsoft.md" >}}) Clarity，Clarity 同样也是[开源的](https://github.com/microsoft/clarity)，但其实完全没有 Self-host 的必要，MSFT 也宣布这款产品是永久免费的，显然 MSFT 希望走 GA 最开始的模式，通过免费来吸引用户来获取更多的网站数据。

<a id="figure--fig:"></a>

{{< figure src="/ox-hugo/_20220907_233524screenshot.png" >}}


### 观点 {#观点}

PH 之所以能够在 GA 一家独大的市场中快速成长一方面是它确实解决了 GA 一直无法完美的解决的问题，GA 太想要什么都做了，UA 的模式明显便相遇传统的电商模式，而面对 SaaS 的崛起 UA 完全无法满足这些客户的诉求，GA4 大刀阔斧的改进让 GA 变得更加灵活，足以应付多种商业模式，但是更加灵活也就意味着上手成本增加。而 PH 在这个市场中瞄准了 toB 的 SaaS 领域的客户，很多功能也都是面向这类型客户设计的，所以对我们来说 GA 和 PH 之间自然会选择后者。

但毕竟是新产品，PH 对于流量渠道的分析与 GA 还是有很大的差距，毕竟 GA360 加上 Adwords 和 Search Console 这样的产品，GA 在流量来源分析上基本上没有对手，其他的数据类和市场营销类的产品也基本上都会和 GA 集成，而 PH 只能自己做了一堆不怎么好用的 App。但是流量分析以 PH 的能力大概率也无法替代 GA，所以 PH 和 GA 应该很长一段时间还是会同时被使用。现在的 SaaS 产品几乎都是这样，没有一个产品可以完美的解决所有人的使用场景，尤其在 toB 的领域，使用不同的产品几乎是不可避免的，而打通各个产品会成为所有 toB 类型产品的必备能力。

[^fn:1]: <https://posthog.com/handbook/company/story>
